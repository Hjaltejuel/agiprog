@page "/"
@inject MeetingService meetingService
@inject IToastService toastService
@inject NavigationManager NavigationManager
@using Data
<section>
    <div class="wrapper">
        <h1 class="alpha lato thin thick-header-line uppercase ls-small">
            Agiprog
        </h1>
        <p class="mega open-sans bold uppercase">
            Learning agile made easy!
        </p>
    </div>
</section>

<div class="form__group field">
    <input @bind="meeting"  @onkeyup="onKeyPress" disabled="@IsDisabled" type="input" class="form__field" placeholder="@placeholder" name="name" id='name' required />
    <label for="name" class="form__label">Meeting ID</label>
</div>
<div style="max-height:500px; margin-top:1.5em;">
    <AuthorizeView>
        <Authorized>
            <ul>
                @foreach (var meet in meetingService.FindAllMeetings())
                {
                    <li><h5>Meeting ID : @meet.MeetingId </h5></li>
                }

            </ul>
        </Authorized>
    </AuthorizeView>
</div>
@code {
    private String meeting;
    private bool IsDisabled { get; set; }
    private String placeholder = "asdfasdfsa";


    private void onChang(ChangeEventArgs args)
    {

    }

    private async void onKeyPress(KeyboardEventArgs args)
    {
        StateHasChanged();
  
        if (args.Key == "Enter")
        {
            IsDisabled = true;

            var result = await meetingService.FindMeeting(meeting);
            if (result == null)
            {
                toastService.ShowWarning("We were unable to find your specified meeting!");
            }
            else
            {
                NavigationManager.NavigateTo("/meeting/" + result.MeetingId);
            }

        }
        IsDisabled = false;
        StateHasChanged();
    }

}


